---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# SQAPI

<!-- badges: start -->
<!-- badges: end -->

The goal of SQAPI is to allow user friendly interaction with SQUIDLE+ API through r.

## Installation

You can install the development version of SQAPI from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("sajessop/SQAPI")
```

## Example

These are a few basic examples which shows you how to build a url and send a request:

```{r example}
library(SQAPI)
# # Example 1: Full GET request example
# # Create instance of SQAPI
# api <- SQAPI$new()
# # Create filters
# my_filters <- query_filter(name = "annotation_set_id", op = "eq", val = "5432")
# # Create other parameters
# my_params <- query_params(page = "14", results_per_page = "56")
# # Append filters and parameters and send request
# r <- request("GET", api, "api/annotation", my_filters, my_params)
# # Parse response
# p <- parse(r, my_params)
# 
# # Example 2: POST example
# # Create instance of SQAPI
# api <- SQAPI$new()
# # Create named list to POST
# post_me <- list("name" = "API test 01",
#                 "description" = "Testing API-created media_collection",
#                 "user_id" = 007)
# # Send request with body attached
# post <- request(
#   verb = "POST",
#   api = api,
#   endpoint = "api/media_collection",
#   body = post_me
# )
# 
# # Example 3: GET request to export endpoint
# # Create instance of SQAPI
# api <- SQAPI$new()
# # Create filters
# my_filters_3 <- query_filter(
#   name = "events",
#   op = "any",
#   val = query_filter(name = "id", op = "is_not_null")
# )
# # Create other params
# my_params_3 <- query_params(
#   template = "data.csv",
#   group_by = "pose.dep",
#   include_columns = c(
#     "id",
#     "key",
#     "path_best",
#     "timestamp_start",
#     "path_best_thm",
#     "pose.timestamp",
#     "pose.lat",
#     "pose.lon",
#     "pose.alt",
#     "pose.dep",
#     "pose.data",
#     "pose.id",
#     "deployment.key",
#     "deployment.campaign.key",
#     "deployment.id",
#     "deployment.campaign.id",
#     "event_log"
#   )
# )
# # Send request
# r3 <- export(
#   api = api,
#   endpoint = "api/media_collection/13453/export",
#   query_filters = my_filters_3,
#   query_parameters = my_params_3,
#   verb = "GET",
#   metadata_filename = "my_metadata3.json"
# )
# 
# # Parse
# p3 <- parse(r3, my_params_3)
```




